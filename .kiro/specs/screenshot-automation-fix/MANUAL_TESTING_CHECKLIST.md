# 手动测试检查清单

## 测试前准备

### 1. 启动应用
```bash
npm run dev
```

等待应用启动，确保：
- Vite 开发服务器在 http://127.0.0.1:5173 运行
- Electron 窗口成功打开
- 主窗口显示"批量自动化工具"界面

### 2. 准备测试环境
- 打开一个可以粘贴图片的应用（如 PowerPoint、Word、画图等）
- 确保屏幕上有可以点击的目标位置
- 准备好测试下移距离功能的场景（如 PPT 幻灯片列表）

---

## 功能测试清单

### ✅ 测试 1: 设置裁剪区域

**步骤：**
1. 点击"设置裁剪区域"按钮
2. 观察覆盖层窗口是否正确打开（全屏透明）
3. 观察是否显示可调整的裁剪框
4. 拖动裁剪框到目标位置
5. 调整裁剪框大小（拖动右下角）
6. 点击"确定"按钮

**预期结果：**
- [ ] 覆盖层窗口正确打开并全屏显示
- [ ] 裁剪框可以拖动和调整大小
- [ ] 点击确定后，覆盖层关闭
- [ ] 主窗口恢复显示并聚焦
- [ ] 按钮文字变为"✓ 裁剪区域已设置"
- [ ] 显示"裁剪区域已设置"成功提示（2-3秒后自动消失）

**测试 ESC 键取消：**
1. 再次点击"设置裁剪区域"按钮
2. 在覆盖层打开后，按 ESC 键

**预期结果：**
- [ ] 覆盖层立即关闭
- [ ] 主窗口恢复显示并聚焦
- [ ] 显示"已取消"提示（3秒后自动消失）
- [ ] 裁剪区域设置保持不变（仍然显示"✓ 裁剪区域已设置"）

---

### ✅ 测试 2: 设置左源位置（粘贴目标位置）

**步骤：**
1. 点击"设置左源位置"按钮
2. 观察覆盖层窗口是否正确打开

**预期结果：**
- [ ] 覆盖层窗口正确打开（全屏半透明）
- [ ] 鼠标光标变为十字光标（crosshair）
- [ ] 屏幕中央显示大号提示："🖱️ 请点击目标位置"
- [ ] 顶部显示操作说明："点击屏幕上任意位置设置窗口焦点位置"

**步骤（继续）：**
3. 在屏幕上任意位置点击

**预期结果：**
- [ ] 覆盖层立即关闭
- [ ] 主窗口恢复显示并聚焦
- [ ] 按钮文字变为"✓ 左源位置已设置 (x, y)"（显示实际坐标）
- [ ] 显示"左源位置已设置: (x, y)"成功提示（2秒后自动消失）

**测试 ESC 键取消：**
1. 再次点击"设置左源位置"按钮
2. 在覆盖层打开后，按 ESC 键

**预期结果：**
- [ ] 覆盖层立即关闭
- [ ] 主窗口恢复显示并聚焦
- [ ] 显示"已取消"提示（3秒后自动消失）
- [ ] 左源位置设置保持不变

---

### ✅ 测试 3: 设置右源位置（截图前点击位置）

**步骤：**
1. 点击"设置右源位置"按钮
2. 观察覆盖层窗口是否正确打开

**预期结果：**
- [ ] 覆盖层窗口正确打开（全屏半透明）
- [ ] 鼠标光标变为十字光标（crosshair）
- [ ] 屏幕中央显示大号提示："🖱️ 请点击目标位置"
- [ ] 顶部显示操作说明："点击屏幕上任意位置设置窗口焦点位置"

**步骤（继续）：**
3. 在屏幕上任意位置点击

**预期结果：**
- [ ] 覆盖层立即关闭
- [ ] 主窗口恢复显示并聚焦
- [ ] 按钮文字变为"✓ 右源位置已设置 (x, y)"（显示实际坐标）
- [ ] 显示"右源位置已设置: (x, y)"成功提示（2秒后自动消失）

**测试 ESC 键取消：**
1. 再次点击"设置右源位置"按钮
2. 在覆盖层打开后，按 ESC 键

**预期结果：**
- [ ] 覆盖层立即关闭
- [ ] 主窗口恢复显示并聚焦
- [ ] 显示"已取消"提示（3秒后自动消失）
- [ ] 右源位置设置保持不变

---

### ✅ 测试 4: 设置循环次数

**步骤：**
1. 观察循环次数输入框的默认值
2. 尝试输入不同的值：
   - 输入 5
   - 输入 0（应该自动变为 1）
   - 输入 -5（应该自动变为 1）
   - 输入非数字（应该自动变为 1）

**预期结果：**
- [ ] 默认值为 3
- [ ] 可以输入正整数（如 5）
- [ ] 输入 0 或负数时，自动转换为 1
- [ ] 输入非数字时，自动转换为 1

---

### ✅ 测试 5: 设置下移距离

**步骤：**
1. 观察下移距离输入框的默认值
2. 尝试输入不同的值：
   - 输入 50
   - 输入 100
   - 输入 -10（应该自动变为 0）
   - 输入非数字（应该自动变为 0）

**预期结果：**
- [ ] 默认值为 0
- [ ] 显示"像素"单位标签
- [ ] 可以输入非负整数（如 50, 100）
- [ ] 输入负数时，自动转换为 0
- [ ] 输入非数字时，自动转换为 0

---

### ✅ 测试 6: 执行批量任务（下移距离 = 0）

**准备：**
1. 确保已设置裁剪区域、左源位置、右源位置
2. 设置循环次数为 2
3. 设置下移距离为 0
4. 打开一个可以粘贴图片的应用（如画图）

**步骤：**
1. 点击"开始执行"按钮
2. 观察任务执行过程

**预期结果：**
- [ ] 主窗口最小化
- [ ] 显示进度："进度: 1 / 2"
- [ ] 观察到以下操作序列（循环 2 次）：
  - 鼠标移动到右源位置并点击
  - 等待 300ms
  - 截取裁剪区域
  - 等待 300ms
  - 鼠标移动到左源位置并点击
  - 等待 300ms
  - 粘贴图片（Ctrl+V）
  - 等待 1000ms
- [ ] 显示进度："进度: 2 / 2"
- [ ] 完成后显示"批量操作完成"
- [ ] 主窗口恢复并聚焦
- [ ] 按钮恢复为"开始执行"

---

### ✅ 测试 7: 执行批量任务（下移距离 > 0）

**准备：**
1. 打开 PowerPoint 或类似应用，显示幻灯片列表视图
2. 确保已设置裁剪区域、左源位置、右源位置
3. 设置循环次数为 3
4. 设置下移距离为 50（或根据实际幻灯片间距调整）

**步骤：**
1. 点击"开始执行"按钮
2. 观察任务执行过程

**预期结果：**
- [ ] 第一次循环：在初始位置执行操作
- [ ] 第二次循环：在初始位置 + 50 像素处执行操作
- [ ] 第三次循环：在初始位置 + 100 像素处执行操作
- [ ] 每次循环后，左右源位置都向下移动 50 像素
- [ ] 完成后显示"批量操作完成"
- [ ] 主窗口恢复并聚焦

---

### ✅ 测试 8: 任务执行中按 ESC 停止

**步骤：**
1. 设置循环次数为 10
2. 点击"开始执行"按钮
3. 在任务执行过程中（如第 2 或 3 次循环时），按 ESC 键

**预期结果：**
- [ ] 任务立即停止执行
- [ ] 显示"批量操作已停止"提示
- [ ] 主窗口恢复并聚焦
- [ ] 按钮恢复为"开始执行"

---

### ✅ 测试 9: 错误场景 - 未设置配置

**步骤：**
1. 刷新应用或重新启动
2. 不设置任何配置，直接点击"开始执行"

**预期结果：**
- [ ] 显示错误提示："请先设置裁剪区域"
- [ ] 任务不执行

**步骤：**
3. 设置裁剪区域
4. 不设置左源位置，点击"开始执行"

**预期结果：**
- [ ] 显示错误提示："请先设置左源位置"
- [ ] 任务不执行

**步骤：**
5. 设置左源位置
6. 不设置右源位置，点击"开始执行"

**预期结果：**
- [ ] 显示错误提示："请先设置右源位置"
- [ ] 任务不执行

---

### ✅ 测试 10: 窗口状态恢复

**测试场景 1：覆盖层加载失败**
1. 停止 Vite 开发服务器（Ctrl+C）
2. 点击"设置左源位置"或"设置右源位置"

**预期结果：**
- [ ] 显示错误提示："连接服务失败，请检查开发服务器是否启动"
- [ ] 主窗口保持可见并聚焦
- [ ] 应用仍然可以正常操作

**测试场景 2：覆盖层超时**
（此场景需要模拟，正常情况下不会发生）
- 如果覆盖层 30 秒内没有响应，应该自动超时并恢复

**预期结果：**
- [ ] 显示错误提示："操作超时，请重试"
- [ ] 主窗口恢复可见并聚焦

---

## 测试总结

### 通过标准
- [ ] 所有功能测试项都通过
- [ ] 所有 ESC 键取消操作都正常工作
- [ ] 所有错误场景都正确处理
- [ ] 窗口状态在所有情况下都正确恢复
- [ ] 下移距离功能正确工作
- [ ] 没有发现应用无响应或卡死的情况

### 已知问题记录
（如果发现任何问题，请在此记录）

---

## 测试完成后

请回答以下问题：
1. 所有测试项是否都通过？
2. 是否发现任何问题或异常行为？
3. 下移距离功能是否按预期工作？
4. ESC 键取消功能是否在所有场景下都正常工作？
5. 窗口状态管理是否正确（没有窗口卡死或无响应）？

如果所有测试都通过，我们可以继续下一个任务。
如果发现问题，请详细描述问题场景，我会帮助修复。
